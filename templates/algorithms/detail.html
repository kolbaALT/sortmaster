{% extends 'base.html' %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h3><i class="bi bi-cpu"></i> {{ algorithm.name }}</h3>
                    <span class="badge bg-{% if algorithm.difficulty_level == 1 %}success{% elif algorithm.difficulty_level == 2 %}warning{% else %}danger{% endif %} fs-6">
                        {% if algorithm.difficulty_level == 1 %}–õ–µ–≥–∫–∏–π{% elif algorithm.difficulty_level == 2 %}–°—Ä–µ–¥–Ω–∏–π{% else %}–°–ª–æ–∂–Ω—ã–π{% endif %}
                    </span>
                </div>
            </div>
            <div class="card-body">
                <p class="lead">{{ algorithm.description|safe }}</p>

                <h5>üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞</h5>
                <div class="row mb-4">
                    <div class="col-md-6">
                        <ul class="list-unstyled">
                            <li><strong>–õ—É—á—à–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> {{ algorithm.complexity_best }}</li>
                            <li><strong>–°—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> {{ algorithm.complexity_average }}</li>
                            <li><strong>–•—É–¥—à–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> {{ algorithm.complexity_worst }}</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <ul class="list-unstyled">
                            <li><strong>–ü–∞–º—è—Ç—å:</strong> {{ algorithm.space_complexity }}</li>
                            <li><strong>–°—Ç–∞–±–∏–ª—å–Ω—ã–π:</strong> {% if algorithm.is_stable %}‚úÖ –î–∞{% else %}‚ùå –ù–µ—Ç{% endif %}</li>
                            <li><strong>–ê–Ω–≥–ª–∏–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</strong> {{ algorithm.name_en }}</li>
                        </ul>
                    </div>
                </div>

                {% if user.is_authenticated and user_stats %}
                <h5>üìà –¢–≤–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="text-center">
                            <h6 class="text-primary">{{ user_stats.total_sessions }}</h6>
                            <small>–í—Å–µ–≥–æ —Å–µ—Å—Å–∏–π</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="text-center">
                            <h6 class="text-success">{{ user_stats.completed_sessions }}</h6>
                            <small>–ó–∞–≤–µ—Ä—à–µ–Ω–æ</small>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="text-center">
                            <h6 class="text-warning">{{ user_stats.best_time|default:"-"|floatformat:2 }}{% if user_stats.best_time %}–º—Å{% endif %}</h6>
                            <small>–õ—É—á—à–µ–µ –≤—Ä–µ–º—è</small>
                        </div>
                    </div>
                </div>
                {% endif %}

                <div class="d-grid gap-2 d-md-flex">
                    <a href="{% url 'algorithms:simulator' algorithm.id %}" class="btn btn-primary btn-lg">
                        <i class="bi bi-play-circle"></i> –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–º—É–ª—è—Ç–æ—Ä
                    </a>
                    <a href="{% url 'algorithms:list' %}" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left"></i> –ö —Å–ø–∏—Å–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
                    </a>
                </div>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞ Python -->
        <div class="card mt-4">
            <div class="card-header">
                <h5><i class="bi bi-code-slash"></i> üêç –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python</h5>
            </div>
            <div class="card-body">
                <pre><code class="python">{% if algorithm.name_en == "Bubble Sort" %}def bubble_sort(arr):
    n = len(arr)
    for i in range(n):
        # –§–ª–∞–≥ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
        swapped = False
        for j in range(0, n - i - 1):
            # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            if arr[j] > arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                swapped = True
        # –ï—Å–ª–∏ –æ–±–º–µ–Ω–æ–≤ –Ω–µ –±—ã–ª–æ, –º–∞—Å—Å–∏–≤ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
        if not swapped:
            break
    return arr

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = bubble_sort(numbers.copy())
print(f"–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {numbers}")
print(f"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: {sorted_numbers}"){% elif algorithm.name_en == "Selection Sort" %}def selection_sort(arr):
    n = len(arr)
    for i in range(n):
        # –ù–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –æ—Å—Ç–∞–≤—à–µ–π—Å—è —á–∞—Å—Ç–∏
        min_idx = i
        for j in range(i + 1, n):
            if arr[j] < arr[min_idx]:
                min_idx = j
        # –ú–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å –ø–µ—Ä–≤—ã–º
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    return arr

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = selection_sort(numbers.copy())
print(f"–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {numbers}")
print(f"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: {sorted_numbers}"){% elif algorithm.name_en == "Insertion Sort" %}def insertion_sort(arr):
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        # –ü–µ—Ä–µ–º–µ—â–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –±–æ–ª—å—à–µ key –Ω–∞ –æ–¥–Ω—É –ø–æ–∑–∏—Ü–∏—é –≤–ø–µ—Ä–µ–¥
        while j >= 0 and arr[j] > key:
            arr[j + 1] = arr[j]
            j -= 1
        arr[j + 1] = key
    return arr

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = insertion_sort(numbers.copy())
print(f"–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {numbers}")
print(f"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: {sorted_numbers}"){% else %}# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è {{ algorithm.name }} –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ
def {{ algorithm.name_en|lower|cut:" "|cut:"-" }}_sort(arr):
    # TODO: –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
    pass{% endif %}</code></pre>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –Ω–∞ C++ -->
        <div class="card mt-4">
            <div class="card-header">
                <h5><i class="bi bi-code-slash"></i> ‚ö° –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ C++</h5>
            </div>
            <div class="card-body">
                <pre><code class="cpp">{% if algorithm.name_en == "Bubble Sort" %}#include <iostream>
#include <vector>
using namespace std;

void bubbleSort(vector<int>& arr) {
    int n = arr.size();
    for (int i = 0; i < n; i++) {
        bool swapped = false;
        for (int j = 0; j < n - i - 1; j++) {
            if (arr[j] > arr[j + 1]) {
                swap(arr[j], arr[j + 1]);
                swapped = true;
            }
        }
        if (!swapped) break;
    }
}

int main() {
    vector<int> numbers = {64, 34, 25, 12, 22, 11, 90};

    cout << "–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: ";
    for (int num : numbers) cout << num << " ";

    bubbleSort(numbers);

    cout << "\n–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: ";
    for (int num : numbers) cout << num << " ";

    return 0;
}{% elif algorithm.name_en == "Selection Sort" %}#include <iostream>
#include <vector>
using namespace std;

void selectionSort(vector<int>& arr) {
    int n = arr.size();
    for (int i = 0; i < n - 1; i++) {
        int min_idx = i;
        for (int j = i + 1; j < n; j++) {
            if (arr[j] < arr[min_idx]) {
                min_idx = j;
            }
        }
        swap(arr[i], arr[min_idx]);
    }
}

int main() {
    vector<int> numbers = {64, 34, 25, 12, 22, 11, 90};

    cout << "–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: ";
    for (int num : numbers) cout << num << " ";

    selectionSort(numbers);

    cout << "\n–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: ";
    for (int num : numbers) cout << num << " ";

    return 0;
}{% elif algorithm.name_en == "Insertion Sort" %}#include <iostream>
#include <vector>
using namespace std;

void insertionSort(vector<int>& arr) {
    int n = arr.size();
    for (int i = 1; i < n; i++) {
        int key = arr[i];
        int j = i - 1;
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        arr[j + 1] = key;
    }
}

int main() {
    vector<int> numbers = {64, 34, 25, 12, 22, 11, 90};

    cout << "–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: ";
    for (int num : numbers) cout << num << " ";

    insertionSort(numbers);

    cout << "\n–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: ";
    for (int num : numbers) cout << num << " ";

    return 0;
}{% else %}// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è {{ algorithm.name }} –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ
#include <iostream>
#include <vector>
using namespace std;

void {{ algorithm.name_en|lower|cut:" "|cut:"-" }}Sort(vector<int>& arr) {
    // TODO: –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
}{% endif %}</code></pre>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º —Ä–∞–±–æ—Ç—ã -->
        <div class="card mt-4">
            <div class="card-header">
                <h5><i class="bi bi-lightbulb"></i> üìö –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h5>
            </div>
            <div class="card-body">
                {% if algorithm.name_en == "Bubble Sort" %}
                <ol>
                    <li><strong>–ü—Ä–æ—Ö–æ–¥ –ø–æ –º–∞—Å—Å–∏–≤—É:</strong> –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –º–∞—Å—Å–∏–≤—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑</li>
                    <li><strong>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ—Å–µ–¥–µ–π:</strong> –ù–∞ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Ö–æ–¥–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å–æ—Å–µ–¥–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã</li>
                    <li><strong>–û–±–º–µ–Ω –º–µ—Å—Ç–∞–º–∏:</strong> –ï—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç–æ—è—Ç –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –º–µ–Ω—è–µ—Ç –∏—Ö –º–µ—Å—Ç–∞–º–∏</li>
                    <li><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:</strong> –ï—Å–ª–∏ –∑–∞ –ø—Ä–æ—Ö–æ–¥ –Ω–µ –±—ã–ª–æ –æ–±–º–µ–Ω–æ–≤, –º–∞—Å—Å–∏–≤ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω</li>
                </ol>
                {% elif algorithm.name_en == "Selection Sort" %}
                <ol>
                    <li><strong>–ü–æ–∏—Å–∫ –º–∏–Ω–∏–º—É–º–∞:</strong> –ù–∞—Ö–æ–¥–∏—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–µ–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —á–∞—Å—Ç–∏</li>
                    <li><strong>–û–±–º–µ–Ω:</strong> –ú–µ–Ω—è–µ—Ç –µ–≥–æ –º–µ—Å—Ç–∞–º–∏ —Å –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –Ω–µ–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —á–∞—Å—Ç–∏</li>
                    <li><strong>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:</strong> –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –æ—Å—Ç–∞–≤—à–µ–π—Å—è —á–∞—Å—Ç–∏ –º–∞—Å—Å–∏–≤–∞</li>
                    <li><strong>–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:</strong> –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –¥–æ –ø–æ–ª–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</li>
                </ol>
                {% elif algorithm.name_en == "Insertion Sort" %}
                <ol>
                    <li><strong>–í–∑—è—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞:</strong> –ë–µ—Ä–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –Ω–µ–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —á–∞—Å—Ç–∏</li>
                    <li><strong>–ü–æ–∏—Å–∫ –º–µ—Å—Ç–∞:</strong> –ù–∞—Ö–æ–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —á–∞—Å—Ç–∏</li>
                    <li><strong>–í—Å—Ç–∞–≤–∫–∞:</strong> –í—Å—Ç–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –º–µ—Å—Ç–æ</li>
                    <li><strong>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ:</strong> –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤</li>
                </ol>
                {% else %}
                <p>–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ {{ algorithm.name }} –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–∑–∂–µ.</p>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-lightbulb"></i> –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li class="mb-2">üéØ –°–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∏ —Ç–µ–æ—Ä–∏—é</li>
                    <li class="mb-2">üëÄ –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–ª–µ–¥–∏ –∑–∞ –∫–∞–∂–¥—ã–º —à–∞–≥–æ–º</li>
                    <li class="mb-2">üîÑ –ü–æ–ø—Ä–æ–±—É–π —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –º–∞—Å—Å–∏–≤–æ–≤</li>
                    <li class="mb-2">‚è±Ô∏è –ó–∞—Å–µ–∫–∞–π –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</li>
                    <li class="mb-2">üèÜ –°–æ—Ä–µ–≤–Ω—É–π—Å—è —Å –¥—Ä—É–∑—å—è–º–∏</li>
                </ul>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5><i class="bi bi-question-circle"></i> –ß—Ç–æ –¥–∞–ª—å—à–µ?</h5>
            </div>
            <div class="card-body">
                <p>–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:</p>
                <a href="{% url 'challenges:list' %}" class="btn btn-warning btn-sm mb-2 d-block">
                    <i class="bi bi-trophy"></i> –ü—Ä–æ–π–¥–∏ —á–µ–ª–ª–µ–Ω–¥–∂
                </a>
                <a href="{% url 'algorithms:comparison' %}" class="btn btn-info btn-sm d-block">
                    <i class="bi bi-bar-chart"></i> –°—Ä–∞–≤–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
